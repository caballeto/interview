package interviewbit.Dp;

import java.util.Arrays;
import java.util.List;

public class _buy_stock2 {
  public static int maxProfit(final List<Integer> array) {
    if (array.size() <= 1) return 0;
    if (array.size() == 3 || array.size() == 2) return maxProfitOfRange(array, 0, array.size() - 1);
    int result = 0;
    int n = array.size();
    for (int i = 0; i < n - 3; i++) {
      for (int j = i + 2; j < n - 1; j++) {
        result = Math.max(result, maxProfitOfRange(array, i, j - 1) + maxProfitOfRange(array, j, n - 1));
      }
    }

    return result;
  }

  public static int maxProfitOfRange(final List<Integer> array, int lo, int hi) {
    if (hi <= lo) return 0;
    int answer = 0;
    int min = Integer.MAX_VALUE;

    for (int i = lo; i <= hi; i++) {
      int val = array.get(i);
      answer = Math.max(answer, val - min);
      min = Math.min(min, val);
    }

    return answer;
  }

  public static void main(String[] args) {
    System.out.println(maxProfit(Arrays.asList(3139646, 9336763, 4447421, 8608763, 9365310, 909412, 7117235, 6312877, 9994010, 7651968, 3218062, 6531522, 4127388, 6862947, 3778257, 6748303, 9222597, 9784691, 3225550, 2265884, 5188955, 9787589, 4633241, 2181957, 5346608, 5175639, 7618685, 8250665, 3502787, 5513224, 5281809, 2188966, 1010617, 2574865, 4364165, 1283499, 3223498, 8312083, 2280176, 9728671, 4871061, 2242415, 837732, 402403, 7298807, 5665709, 4677337, 1995766, 6931438, 8614095, 1000025, 2388288, 1567126, 9625683, 3633204, 1163459, 2010093, 2562554, 9411398, 4288200, 4190549, 902115, 4329124, 2325251, 5640425, 5511537, 5056046, 7239009, 229888, 4788765, 8768185, 2416699, 2925521, 2393167, 9443038, 3692503, 526882, 1779885, 7534079, 1268849, 88697, 4136769, 3786577, 1125286, 4174871, 5437024, 4177602, 5492979, 6123055, 4174512, 6113314, 8653186, 3876963, 3262360, 483165, 6764455, 9436474, 7907735, 8351161, 1464183, 1869370, 6431407, 5208856, 107619, 3706045, 2105243, 2484876, 1152152, 9891951, 8933305, 9214959, 375522, 3606525, 3395931, 892200, 7092359, 9677020, 2948634, 5211635, 9662722, 7719089, 4549376, 9729152, 880597, 9386137, 9996890, 2194574, 8585265, 3667422, 9322444, 2921967, 4680896, 4242609, 4799741, 7839779, 1052034, 6859570, 7469351, 4576610, 90341, 6101570, 4709239, 4342081, 597078, 526624, 8867710, 9933461, 1754553, 8992356, 6662929, 2119848, 8337802, 5398628, 1317439, 7035240, 119626, 5655118, 4654617, 1866071, 8277327, 7160440, 7676817, 1475154, 4865528, 9930503, 4322744, 2751698, 3240373, 4422527, 6415410, 9613476, 6960314, 8770230, 494726, 3857004, 7756652, 6551863, 9233710, 778517, 5446272, 5182406, 701042, 9886636, 6074446, 1598838, 9938813, 9538364, 4669497, 8510376, 944303, 3352160, 874761, 3731230, 2688486, 394457, 5290, 394663, 6702701, 1868985, 5356343, 1229286, 8094098, 2769079, 8358315, 8644334, 3468722, 6844375, 9711105, 9700941, 6443874, 2845127, 769406, 5823153, 6822999, 4306257, 9841369, 5008168, 1012678, 2315225, 6003924, 4647788, 6077985, 9863438, 8321941, 2561546, 8615178, 9705161, 1936384, 4957666, 1575049, 3229074, 1401525, 5339028, 9976446, 2809955, 1475409, 5792920, 8642190, 73915, 1012301, 669188, 1404566, 6743604, 2855300, 1182232, 7195987, 1493302, 2665775, 6910583, 2886567, 9411879, 475789, 8229058, 1151624, 1969732, 7597908, 9113273, 5262252, 3463891, 8081, 1459038, 7293941, 2790711, 9907502, 2767063, 3763194, 6579991, 6671160, 9475766, 5083753, 9730172, 2922599, 8144590, 9577294, 6357153, 5982415, 7093048, 9740397, 6910399, 1242329, 9622072, 4096889, 4714632, 2072157, 2197658, 2732342, 7568008, 562012, 7759200, 3323475, 7906753, 9176288, 8744176, 9904183, 2263825, 3880126, 2150412, 8134741, 7102283, 3172890, 328080, 9220195, 5614344, 2662848, 1694488, 811810, 5480997, 3464621, 6107736, 2822336, 5762919, 8626305, 1762938, 8666277, 7814150, 5652665, 4378533, 5351020, 9211675, 8207847, 1546438, 9608207, 92154, 8027691, 1983323, 1958000, 8490624, 4970263, 3495080, 4944373, 2223442, 9613650, 7594657, 3258353, 7084904, 1084066, 592750, 1370427, 1932173, 4655943, 5275298, 4747792, 7139539, 6393745, 6324899, 4926806, 774839, 1469670, 9607831, 451722, 8688722, 1866887, 4785462, 8030703, 8155466, 6108532, 712855, 5254150, 172653, 7917133, 8494402, 8258441, 3187300, 3044302, 2090455, 4833250, 7403602, 3302605, 2872214, 2460298, 5423567, 4948710, 7902236, 6199751, 5340297, 4478083, 562726, 7561543, 805841, 1924855, 9734750, 8882552, 2440045, 5541369, 3888460, 7831012, 4208236, 4011452, 941967, 5128327, 905115, 7536961, 9141851, 1238554, 2019610, 734621, 3954338, 5569823, 6387274, 8155801, 6901625, 3544844, 6011256, 2241404, 8946994, 8954073, 1700141, 6061437, 4325798, 5504301, 8277858, 7865092, 1054560, 9762375, 1898900, 1759581, 587877, 4012682, 2535449, 2372066, 8095347, 1416116, 3534835, 1737390, 4714106, 2704300, 3061601, 6186329, 4710852, 801169, 8712358, 5943543, 6681475, 7259881, 9245422, 5215566, 4454052, 7533012, 8498531, 9612726, 2157211, 9348407, 1719583, 5910823, 9666162, 4552677, 4558453, 5846547, 6476255, 362537, 7596115, 3753964, 3176703, 3136185, 9209553, 382934, 3311742, 2103662, 7902204, 3371852, 1985616, 2602080, 342594, 7159178, 6349944, 7785659, 4041854, 8170006, 7897719, 8913339, 883808, 6496356, 5855107, 6722277, 8955205, 8650640, 4794061, 448448, 132946, 616479, 3364030, 9274905, 1030791, 9742673, 5868556, 236640, 1504786, 9802384, 4330096, 7562727, 9226075, 9903126, 5296478, 8405722, 4879544, 1341348, 8897983, 6773532, 2798030, 3095975, 1773847, 6169864, 9941814, 7692874, 2444053, 8925829, 1546038, 2351248, 908265, 7305449, 1515446, 444238, 3678970, 825091, 3734266, 1817956, 6705320, 5235914, 5730642, 2531325, 1783025, 2444295, 1986416, 6845329, 7912226, 1517095, 3862275, 8537411, 1613787, 7711797, 1458585, 1313456, 688736, 5552062, 9689316, 4119634, 4791955, 1639688, 9702471, 4767370, 5978290, 6518203, 8316789, 8083913, 9748054, 5957691, 4497496, 513697, 1781695, 1484408, 3098500, 6200316, 4387924, 2682385, 2956097, 3582938, 5514229, 8194853, 2714364, 7756696, 8451910, 2376550, 1646788, 5502496, 4055457, 2105402, 6078063, 2598413, 607908, 108897, 8622831, 3258985, 7467262, 7686655, 6938845, 4736617, 6264217, 2227083, 4577258, 2141815, 5603165, 3678487, 7397513, 1529560, 1697814, 8670076, 92462, 4333782, 2478217, 9946563, 8012465, 9137083, 298353, 9451506, 9721881, 6301006, 423303, 934195, 9427420, 7849194, 7656838, 8923304, 2521589, 7444661, 9550210, 8393789, 7974520, 3175667, 8216483, 8115706, 8488659, 219204, 29437, 4329892, 1200207, 6514940, 5642404, 4027556, 8428312, 2259561, 9219582, 8995150, 1663493, 1696425, 4048175, 134558, 6672046, 2199915, 371243, 9939853, 5237506, 8276512, 7882270, 2171693, 2839577, 9626808, 435444, 9554940, 27132, 2772310, 5688233, 6829442, 395893, 5355508, 4586654, 6763591, 2422879, 4423647, 1623753, 7346584, 7910847, 1784075, 8574999, 298124, 4000226, 246803, 4358331, 1605168, 4601805, 6120844, 6394642, 9853523, 3700353, 6114706, 6499064, 207919, 6384472, 5102193, 9178674, 2669830, 7825583, 8868612, 7739554, 4262722, 1856412, 8554102, 2851608, 3133004, 9399378, 1918757, 6711515, 981571, 8702279, 879902, 43787, 1299446, 8218194, 6694427, 2924322, 7048219, 633564, 3120385, 3364485, 3361817, 2498735, 4552889, 196166, 3038472, 2386737, 4725648, 4848927, 2132891, 3659323, 8070819, 7246482, 1083556, 9018895, 8671039, 5589610, 6958552, 3189511, 3268474, 3535647, 5206620, 4454751, 8514063, 63252, 5715656, 8703460, 5682660, 2654101, 7624349, 5495913, 7981965, 8365382, 7155506, 5137802, 2287666, 7595497, 7376232, 3092788, 2513036, 4577886, 7681306, 2409621, 5930559, 4333975, 5040759, 2152173, 788980, 4029908, 8314478, 7904348, 3414655, 8287447, 6829545, 2955667, 358138, 1495278, 5968625, 9953131, 8578883, 112874, 3211580, 1984266, 8395988, 5405656, 1990983, 3400617, 779330, 1130162, 3780891, 8642030, 6409093, 2080855, 9182580, 1792799, 9797233, 7315704, 9653560, 2812496, 9074467, 1656454, 9413975, 1369162, 5299910, 421435, 2890332, 2481565, 5473572, 6714470, 9136390, 6158756, 7111225, 3283016, 6340934, 8079911, 8035910, 8634401, 4953334, 872765, 4813051, 7477105, 1779347, 8430302, 3723079, 9967127, 5473326, 6968873, 276424, 473121, 6801208, 4473682, 9885125, 5663767, 4236000, 9774909, 3448082, 536917, 9400799, 994859, 517027, 2617254, 24796, 8410026, 2766328, 1293609, 975006, 3944407, 1980523, 1160080, 6612667, 4990592, 5968982, 5836788, 8300716, 7257037, 2367192, 9529647, 7395852, 7885620, 108223, 4802566, 5497602, 6608650, 4303323, 7828626, 5917877, 7510910, 8693949, 7286332, 3359007, 5897450, 3985299, 1744646, 9993076, 7558524, 9058808, 5921708, 3113888, 3758482, 8871057, 6929305, 9235105, 1461658, 3796404, 9577657, 732786, 7416983, 2113427, 5018046, 2194956, 4471379, 9312640, 8121936, 9248878, 5669676, 4941974, 4782516, 3649031, 8444802, 683943, 7906185, 9513472, 4382115, 6800059, 1602169, 103186, 7420486, 9416869, 2887678, 2209887, 3520094, 6802879, 5468242, 8618811, 5866122, 3036122, 3664115, 150425, 205740, 2671694, 7164636, 2765959, 6632692, 6775094, 1008750, 7574316, 3615663, 3681501, 3541657, 3429838, 1509913, 3921454, 3484261, 9990731, 313357, 2931297, 7481198, 9919792, 8010701, 6966581, 9145996, 9564971, 4793976, 6705559, 3463658, 9001723, 4542409, 4445539, 4215370, 1776336, 525439, 2186585, 7843818, 6953092, 6291161, 1778065, 4809100, 3208896, 5265417, 8383348, 8839764, 4493349, 4700844)));
  }
}
